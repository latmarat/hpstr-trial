<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>Stress-strain data from ABAQUS simulations using Python &#8211; research blog</title>
<meta name="description" content="The post describes a Python script for obtaining stress--strain data from ABAQUS simulations with representative volume elements of heterogeneous microstructures.">
<meta name="keywords" content="abaqus, python">



<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Stress-strain data from ABAQUS simulations using Python">
<meta property="og:description" content="The post describes a Python script for obtaining stress--strain data from ABAQUS simulations with representative volume elements of heterogeneous microstructures.">
<meta property="og:url" content="/aba-ss/">
<meta property="og:site_name" content="research blog">





<link rel="canonical" href="/aba-ss/">
<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="research blog Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<!-- Webfonts -->
<link href="//fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic" rel="stylesheet" type="text/css">

<meta http-equiv="cleartype" content="on">

<!-- Load Modernizr -->
<script src="/assets/js/vendor/modernizr-2.6.2.custom.min.js"></script>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/images/apple-touch-icon-144x144-precomposed.png">



</head>

<body id="post" >

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->
<nav id="dl-menu" class="dl-menuwrapper" role="navigation">
	<button class="dl-trigger">Open Menu</button>
	<ul class="dl-menu">
		<li><a href="/">Home</a></li>
		<li>
			<a href="#">The author</a>
			<ul class="dl-submenu">
				<li>
					<img src="/images/avatar.jpg" alt="Marat I. Latypov photo" class="author-photo">
					<h4>Marat I. Latypov</h4>
					<p>Materials Scientist at Georgia Tech Lorraine.</p>
				</li>
				<li><a href="/about"><span class="btn btn-inverse">Learn More</span></a></li>
				<li>
					<a href="mailto:marat.latypov@georgiatech-metz.fr"><i class="fa fa-fw fa-envelope"></i> Email</a>
				</li>
				
				
				
				<li>
					<a href="https://linkedin.com/in/latmarat"><i class="fa fa-fw fa-linkedin"></i> LinkedIn</a>
				</li>
				
				
				
				
				
				<li>
					<a href="https://www.researchgate.net/profile/Marat_Latypov"><i class="ai ai-researchgate"></i> ResearchGate</a>
				</li>
					<li>
					<a href="https://scholar.google.com/citations?user=
					We5aJywAAAAJ&hl=en&oi=ao"><i class="ai ai-google-scholar"></i> Google Scholar</a>
				</li>
			</ul><!-- /.dl-submenu -->
		</li>
		<li><a href="/posts/">All Posts</a></li>
		<li><a href="/tags/">All Tags</a></li>
		
	    
	    <li><a href="/about/" >About</a></li>
	  
	    
	    <li><a href="/portfolio/" >Portfolio</a></li>
	  
	    
	    <li><a href="http://latmarat.net" target="_blank">Landing Page</a></li>
	  
	</ul><!-- /.dl-menu -->
</nav><!-- /.dl-menuwrapper -->




<div id="main" role="main">
  <article class="hentry">
    <header class="header-title">
      <div class="header-title-wrap">
        
          <h1 class="entry-title"><a href="/aba-ss/" rel="bookmark" title="Stress-strain data from ABAQUS simulations using Python">Stress-strain data from ABAQUS simulations using Python</a></h1>
        
        <h2><span class="entry-date date published"><time datetime="2016-05-14T00:00:00+02:00">May 14, 2016</time></span></h2>
        
        <p class="entry-reading-time">
          <i class="fa fa-clock-o"></i>
          
Reading time ~5 minutes
        </p><!-- /.entry-reading-time -->
        
      </div><!-- /.header-title-wrap -->
    </header>
    <div class="entry-content">
      <p>The post describes a Python script for obtaining stress–strain data from ABAQUS simulations with representative volume elements of heterogeneous microstructures.</p>

<h1 id="intro">Intro</h1>

<p>There are cases when you may not want to use ABAQUS/CAE to get stress–strain curves from your output database containing the finite element (FE) simulation results, such as</p>

<ol>
  <li>The model is too big for ABAQUS/CAE to handle averaging over elements</li>
  <li>You are tired of clicking on ABAQUS/CAE menu over and over again after each simulation run</li>
  <li>You have many files to post-process</li>
</ol>

<p>ABAQUS offers powerful scripting interface, which is a perfect solution for such cases.</p>

<h1 id="background">Background</h1>

<p>The scripts described here were written specifically for finite element (FE) simulations of deformation of representative volume elements (RVE) of polycrystalline or multiphase microstructures, where one usually has a single part deformed through velocities  or displacements applied on control nodes. Nevertheless, it is hoped that the scripts will be also useful for a more general class of FE simulations.</p>

<p>With the deformation of an RVE in mind, the stress–strain data can be obtained by averaging components of the stress and strain tensors over all integration points in each element (in the case of full integration) and then over all elements in the model (or in a region of the model specified in an Element Set), i.e.</p>

<script type="math/tex; mode=display">% <![CDATA[
\left < S_{ij} \right > = \frac{1}{N}\sum^N_{p=1} S_{ij}^p %]]></script>

<p>for stress tensor and</p>

<script type="math/tex; mode=display">% <![CDATA[
\left < \varepsilon_{ij} \right > = \frac{1}{N}\sum^N_{p=1} \varepsilon_{ij}^p %]]></script>

<p>for strain tensor.</p>

<p>Here <script type="math/tex">N</script> is the number of integration points in the model (or region of the model), <script type="math/tex">S_{ij}^p</script> and  <script type="math/tex">\varepsilon_{ij}^p</script> are the stress and strain tensor components at an integration point <script type="math/tex">p</script>. Note that these equations assume that all elements are of identical size, otherwise it is necessary to introduce weights into the equations.</p>

<p>Now as we have averaged components of the tensors, we can get equivalent stress and strain as follows:</p>

<script type="math/tex; mode=display">% <![CDATA[
\bar{q} = \sqrt{\frac{3}{2}\left < S{ij} \right > \left < S_{ij} \right >} %]]></script>

<p>for stress and</p>

<script type="math/tex; mode=display">% <![CDATA[
\bar{\epsilon} = \sqrt{\frac{2}{3}\left < \varepsilon_{ij} \right > \left < \varepsilon_{ij} \right >} %]]></script>

<p>for strain.</p>

<h1 id="implementation-in-python">Implementation in Python</h1>

<p>The calculation described above is implemented in a Python function called <code class="highlighter-rouge">odb2ss</code> available on GitHub <a href="https://github.com/latmarat/abaqus-py/blob/master/aba-ss.py">here</a>. To get the equivalent stress and strain for all time frames available in your odb, call of the function will look like this:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">eqStress</span><span class="p">,</span> <span class="n">eqStrain</span> <span class="o">=</span> <span class="n">odb2ss</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span><span class="n">instanceName</span><span class="p">,</span><span class="n">setName</span><span class="p">)</span></code></pre></figure>

<p>where <code class="highlighter-rouge">fname</code> is the file name of the output database (without extension, e.g. <em>‘test’</em>), <code class="highlighter-rouge">instanceName</code> is the Instance name of your part of interest (e.g. <em>‘PART-1-1’</em>), and <code class="highlighter-rouge">setName</code> is the name of the Element Set that contains the region for which calculations shall be done.</p>

<p>As a result of this function call, you will have equivalent stress and strain stored in variables <code class="highlighter-rouge">eqStress</code> and <code class="highlighter-rouge">eqStrain</code>. You can plot them immediately in Python if you have <a href="http://matplotlib.org/"><code class="highlighter-rouge">matplotlib</code></a> module installed or just save the data to a text file and plot it using your favorite software. To save the data to a text file, add the following line to the script.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="n">txtFileName</span><span class="p">,</span> <span class="nb">zip</span><span class="p">(</span><span class="n">eqStrain</span><span class="p">,</span><span class="n">eqStress</span><span class="p">))</span></code></pre></figure>

<h1 id="batch-post-processing">Batch post-processing</h1>

<p>If you have a bunch of output databases (i.e. odb files) for which you want to get stress–strain data, copy the <code class="highlighter-rouge">aba-ss.py</code> file to the folder containing your odb files and add a snippet that finds all the odb files and calls <code class="highlighter-rouge">odb2ss</code> function in a <em>for</em>-loop over all odb files.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">glob</span>

<span class="c"># Find odb files</span>
<span class="n">files2search</span> <span class="o">=</span> <span class="s">'*.odb'</span>
<span class="n">odbFiles</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">files2search</span><span class="p">)</span>
<span class="n">odbFiles</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

<span class="c"># Start a loop over odb files</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">f</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">odbFiles</span><span class="p">):</span>

	<span class="c"># Get file name without extension</span>
	<span class="n">fname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">f</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

	<span class="c"># Get equivalent stress, strain from odb</span>
	<span class="n">eqStress</span><span class="p">,</span> <span class="n">eqStrain</span> <span class="o">=</span> <span class="n">odb2ss</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>

	<span class="c"># Save results to npy</span>
	<span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="n">fname</span> <span class="o">+</span> <span class="s">'.out'</span><span class="p">,</span> <span class="nb">zip</span><span class="p">(</span><span class="n">eqStrain</span><span class="p">,</span><span class="n">eqStress</span><span class="p">))</span></code></pre></figure>

<h1 id="some-caveats-and-features">Some caveats and features</h1>

<p>Here are a couple of useful things to know about <code class="highlighter-rouge">odb2ss</code> function.</p>

<h2 id="stress-and-strain-measures">Stress and strain measures</h2>

<p>In this implementation, equivalent stresses and strains are calculated from stress and strain tensors stored in ABAQUS output field variables <code class="highlighter-rouge">S</code> and <code class="highlighter-rouge">LE</code> (logarithmic strain). If you are happy with this choice, you need to request field output for these variables with a desired frequency before running the FE simulation.</p>

<p>Here is a portion of the input file responsible for field output and example of the element output request containing <code class="highlighter-rouge">LE</code> and <code class="highlighter-rouge">S</code> variables.</p>

<p><code class="highlighter-rouge">
** FIELD OUTPUT: STR-STR
**
*Output, field, time interval=1.0
*Node Output
U,
*Element Output, directions=YES
EE, ER, LE, PE, PEEQ, S
</code></p>

<p>To calculate equivalent strain from any other strain tensor, replace <code class="highlighter-rouge">LE</code> with the desired variable in the following line in <code class="highlighter-rouge">odb2ss</code> function:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c"># Get strain</span>
<span class="n">varName</span> <span class="o">=</span> <span class="s">'LE'</span> <span class="c"># put your favorite strain tensor here</span>
<span class="n">tensor</span> <span class="o">=</span> <span class="n">getSymTensorData</span><span class="p">(</span><span class="n">varName</span><span class="p">,</span> <span class="n">myFrame</span><span class="p">,</span> <span class="n">myInstance</span><span class="p">,</span> <span class="n">mySet</span><span class="p">,</span> <span class="n">numElements</span><span class="p">)</span>
<span class="n">strain</span> <span class="o">=</span> <span class="n">getFullTensorData</span><span class="p">(</span><span class="n">tensor</span><span class="p">)</span></code></pre></figure>

<p>Similarly, you can access any other tensor or scalar field data from the odb for purposes other than getting the stress–strain curve. For scalars, there is a function <code class="highlighter-rouge">getScalarData</code> in the same Python file, which will return a scalar quantity averaged over all elements in the requested element set.</p>

<h2 id="run-time-messages">Run-time messages</h2>

<p>The script writes some runtime messages to a file <code class="highlighter-rouge">odb_aba-ss.txt</code> created in the folder where <code class="highlighter-rouge">aba-ss.py</code> was run. In this file, you can see some useful information, such as, for which Step and  Instance the calculations are carried out as well as how many time frames are available in your odb.</p>

<p>Here is an example of run-time messages if the script has completed with no errors</p>

<p><code class="highlighter-rouge">
odb was successfully opened at test.odb
Working with step Deformation and instance PART-1-1
Number of frames: 3
Current time frame:  0.0000
Current time frame:  1.0000
Current time frame:  2.0000
Done with test, spent 6.86 min
</code></p>

<p>The script will also try to catch the most frequent errors – Instance and Element Set specified do not exist in the odb. If these errors happen, the script will say so in this text file and will tell you the right names of the Instances and Sets available in the odb.</p>

<h2 id="default-values-for-instance-and-set">Default values for instance and set</h2>

<p>The function is defined with <em>‘ALLELEMENTS’</em> as a default name of the Element Set name for which calculation is performed. Also, the first Instance available in the odb is chosen as default. For example, if I have an odb with a single Instance <em>PART-1-1</em>, the following two calls of the function will yield exactly the same results</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">eqStress</span><span class="p">,</span> <span class="n">eqStrain</span> <span class="o">=</span> <span class="n">odb2ss</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span><span class="s">'PART-1-1'</span><span class="p">,</span><span class="s">'ALLELEMENTS'</span><span class="p">)</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">eqStress</span><span class="p">,</span> <span class="n">eqStrain</span> <span class="o">=</span> <span class="n">odb2ss</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span></code></pre></figure>

<p>I have the first Instance and <em>‘ALLELEMENTS’</em> Set as default simply because, in most cases, I have a single part and thus a single Instance (my RVE) and <em>‘ALLELELEMENTS’</em> is the Element Set that for which I want to do the calculation most frequently (i.e. over the whole RVE). You can easily change them to your favorite Instance and Element Set names in the following lines of the code.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c"># The first instance is default if None provided</span>
<span class="k">if</span> <span class="n">instanceName</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
	<span class="n">instanceName</span> <span class="o">=</span> <span class="n">myOdb</span><span class="o">.</span><span class="n">rootAssembly</span><span class="o">.</span><span class="n">instances</span><span class="o">.</span><span class="n">keys</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="c"># put your favorite instance here</span>

<span class="c"># 'AllElements' set is default if None provided</span>
<span class="k">if</span> <span class="n">mySetName</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
	<span class="n">mySetName</span> <span class="o">=</span> <span class="s">'ALLELEMENTS'</span> <span class="c"># put your favorite element set here</span></code></pre></figure>

<h1 id="ps-running-python-scripts-in-abaqus">P.S. Running Python scripts in ABAQUS</h1>

<p>If you are not sure how to run the scripts described above, here is a tip. There are two options in running Python scripts in ABAQUS environment.</p>

<ol>
  <li>From ABAQUS command line:
<code class="highlighter-rouge">
abaqus viewer noGUI=script.py
</code></li>
  <li>From ABAQUS/CAE:
 Go to <em>File</em> -&gt; <em>Run Script…</em> and navigate to the script  you need, e.g. <code class="highlighter-rouge">aba-ss.py</code>.</li>
</ol>

<p class="notice"><strong>Final note</strong>: <code class="highlighter-rouge">aba-ss.py</code> may not work in old versions of ABAQUS that do not have numpy module in their Python distribtutions.</p>

      <footer class="entry-meta">
        <span class="entry-tags"><a href="/tags/#abaqus" title="Pages tagged abaqus" class="tag"><span class="term">abaqus</span></a><a href="/tags/#python" title="Pages tagged python" class="tag"><span class="term">python</span></a></span>
        <span>Updated on <span class="entry-date date updated"><time datetime="2015-05-12">May 12, 2015</time></span></span>
        <span class="author vcard"><span class="fn">Marat I. Latypov</span></span>
        
      </footer>
    </div><!-- /.entry-content -->
    <section id="disqus_thread"></section><!-- /#disqus_thread -->
    <div class="read-more">
  
    <div class="read-more-header">
      <a href="/dream2abatet/" class="read-more-btn">Read More</a>
    </div><!-- /.read-more-header -->
    <div class="read-more-content">
      <h3><a href="/emi-info/" title="My talk on quantification of EBSD datasets">My talk on quantification of EBSD datasets</a></h3>
      <p>Slides presented at EMI-2016 conference (Metz, France), October 2016. <a href="/emi-info/">Continue reading</a></p>
    </div><!-- /.read-more-content -->
  
  <div class="read-more-list">
    
      <div class="list-item">
        <h4><a href="/slides/emi-slides/" title="EBSD data analytics for quantification of UFG microstructures">EBSD data analytics for quantification of UFG microstructures</a></h4>
        <span>Published on November 14, 2016</span>
      </div><!-- /.list-item -->
    
      <div class="list-item">
        <h4><a href="/ppt2reveal/" title="How to make an easy transition from PowerPoint to reveal.js">How to make an easy transition from PowerPoint to reveal.js</a></h4>
        <span>Published on August 26, 2016</span>
      </div><!-- /.list-item -->
    
  </div><!-- /.read-more-list -->
</div><!-- /.read-more -->
  </article>
</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo">
    <span>&copy; 2017 Marat I. Latypov. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> using the <a href="https://mademistakes.com/work/hpstr-jekyll-theme/" rel="nofollow">HPSTR Theme</a>.</span>
  </footer>
</div><!-- /.footer-wrapper -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="/assets/js/scripts.min.js"></script>


<!-- Asynchronous Google Analytics snippet -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-61278008-2', 'auto');
  ga('require', 'linkid', 'linkid.js');
  ga('send', 'pageview');
</script>



<script type="text/javascript"
    src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'latmarat'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script'); s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>



</body>
</html>
